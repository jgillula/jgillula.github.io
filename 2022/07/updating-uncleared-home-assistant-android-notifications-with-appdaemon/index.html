








<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Random Hacks | Updating Uncleared Home Assistant Android Notifications with AppDaemon </title>
    <meta name="theme-color" content="#222222"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="/assets/js/jquery.min.js"></script>
    <script src="/assets/js/popper.min.js"></script>
    <script src="/assets/js/bootstrap4.min.js"></script>
    <script src="/assets/js/header.js"></script>
    <script src="/assets/css/svg-with-js/js/fontawesome-all.js"></script>
    <link href="/assets/css/bootstrap4.min.css" rel="stylesheet">
    <link href="/assets/css/theme.css" rel="stylesheet">
    <link href="/assets/css/syntax.css" rel="stylesheet">
 </head>

<body>

<script type="text/javascript">
    WebFontConfig = {
        google: {
            families: ['Ubuntu::latin']
        }
    };
    (function () {
        var wf = document.createElement('script');
        wf.src = ('https:' == document.location.protocol ? 'https' : 'http') +
            '://ajax.googleapis.com/ajax/libs/webfont/1/webfont.js';
        wf.type = 'text/javascript';
        wf.async = 'true';
        var s = document.getElementsByTagName('script')[0];
        s.parentNode.insertBefore(wf, s);
    })();


 function InitCopyPaste(){
   const codeBlocks = document.querySelectorAll("div.highlighter-rouge");

   codeBlocks.forEach((codeblock, index) => {
     const code = codeBlocks[index].innerText;
     const copyCodeButton = document.createElement("button");
     copyCodeButton.innerHTML = "COPY";
     copyCodeButton.classList = "btn btn-sm btn-outline-primary";
     // insert a copy button
     copyCodeButton.onclick = function () {
       window.navigator.clipboard.writeText(code);
       copyCodeButton.innerHTML = "COPIED";
       copyCodeButton.classList.add("btn-success");
       copyCodeButton.classList.remove("btn-outline-primary");

       setTimeout(() => {
         copyCodeButton.innerHTML = "COPY";
         copyCodeButton.classList.remove("btn-success");
         copyCodeButton.classList.add("btn-outline-primary");
       }, 2000);
     };
     // make the button
     codeblock.appendChild(copyCodeButton);
   });
 }

 document.addEventListener("DOMContentLoaded", InitCopyPaste);
</script>


<script>
 $(document).ready(function(){

 const headings = document.querySelectorAll('h1[id], h2[id],h3[id]'); // 1
   const linkContent = '<i class="fas fa-link"></i>'; // 2
   for (const heading of headings) { // 3
                                     const space = document.createElement('span');
     space.innerHTML=" ";
     space.className = "header_link_span";
   const linkIcon = document.createElement('a'); // 4
   linkIcon.setAttribute('href', `#${heading.id}`); // 5
   linkIcon.className = "header_link";
   linkIcon.innerHTML = linkContent; // 6
   space.appendChild(linkIcon); // 7
     heading.appendChild(space);
 }
   });
</script>



<nav class="navbar navbar-expand-lg fixed-top navbar-dark">
    <div class="container">
        <a class="navbar-brand offset-md-1" href="/">Random Hacks</a>
        <button class="navbar-toggler" type="button" data-toggle="collapse"
                data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup"
                aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarNavAltMarkup">
          <div class="navbar-nav">
            <a class="nav-item nav-link" href="/">Home</a>
            <a class="nav-item nav-link" href="/about">About</a>
          </div>
        </div>
    </div>
</nav>

    <div class="wrapper">
      <div class="content">
        <div class="container container-center">
          <div class="row">
            <div class="col-md-8 offset-md-1">
              <div class="article">
                <div class="card">
                  <h1><a href="/2022/07/updating-uncleared-home-assistant-android-notifications-with-appdaemon/">Updating Uncleared Home Assistant Android Notifications with AppDaemon</a></h1>
                  <div class="post-meta">
                    <div class="post-time">
                      <i class="fa fa-calendar-alt"></i>
                      <time>04 Jul 2022</time>
                    </div>
                    <ul>
                      
                        <li><a href="/tag/homeassistant">homeassistant</a></li>
                      
                        <li><a href="/tag/appdaemon">appdaemon</a></li>
                      
                    </ul>
                  </div>
                   <div class="post-content"> 
                     <h1 id="goals">Goals</h1>

<p>For one of my Home Assistant automations, I want to send <a href="https://companion.home-assistant.io/docs/notifications/notifications-basic/">notifications to a couple of Android devices</a>. I also want to be able to update the contents of those notifications when I get new sensor readings, so <a href="https://companion.home-assistant.io/docs/notifications/notifications-basic/#replacing">per the documentation I use a tag</a> to replace the existing notifications.</p>

<p>But there’s one snag that Home Assistant doesn’t support out of the box: if I dismiss (clear) a notification on one of the Android devices, then the next time I try to send an update it will pop up again.</p>

<p>Instead, I want notifications to exist in sort of a session. The session starts the first time the automation sends a notification, and stops when the automation sends a <a href="https://companion.home-assistant.io/docs/notifications/notifications-basic/#clearing"><code class="language-plaintext highlighter-rouge">clear_notification</code></a> message. During the session, new updates to the notification will only be sent to Android devices that haven’t cleared the notification over the course of the session.</p>

<blockquote>
  <p><strong><em>Note: this only works for Android devices, since iOS doesn’t report when notifications are cleared by the user.</em></strong></p>
</blockquote>

<h1 id="complications">Complications</h1>

<p>To accomplish this I wrote an <a href="https://appdaemon.readthedocs.io/">AppDaemon</a> script which will send notifications and listen for the <a href="https://companion.home-assistant.io/docs/notifications/notification-cleared"><code class="language-plaintext highlighter-rouge">mobile_app_notification_cleared</code></a> event to know when a notification has been cleared.</p>

<p>Unfortunately the <a href="https://companion.home-assistant.io/docs/notifications/notification-cleared"><code class="language-plaintext highlighter-rouge">mobile_app_notification_cleared</code></a> event doesn’t contain useful information about what device cleared the notification–it contains a <code class="language-plaintext highlighter-rouge">DEVICE_ID</code> which is a hexadecimal string, but I can’t find any way to easily map that <code class="language-plaintext highlighter-rouge">DEVICE_ID</code> back to the actual string representing the target (i.e. the <code class="language-plaintext highlighter-rouge">&lt;your_device_id_here&gt;</code> in the <a href="https://companion.home-assistant.io/docs/notifications/notifications-basic"><code class="language-plaintext highlighter-rouge">notify.mobile_app_&lt;your_device_id_here&gt;</code></a> service call).</p>

<p>However, when a notification is cleared the event does contain all the data of the notification–including its tag. Thus, by sending each notification with a unique tag that contains both the name of the AppDaemon app <em>and</em> the name of the specific target, we can distinguish between devices when we get the <a href="https://companion.home-assistant.io/docs/notifications/notification-cleared"><code class="language-plaintext highlighter-rouge">mobile_app_notification_cleared</code></a> event.</p>

<h1 id="high-level-overview">High level overview</h1>

<p>At a high level, the AppDaemon app works as follows:</p>

<ol>
  <li>Via the app’s <a href="https://appdaemon.readthedocs.io/en/latest/APPGUIDE.html#configuration-of-apps">YAML configuration</a> you specify the Android devices you want to target, as well as any default data you want to include in every notification. (I.e. the <code class="language-plaintext highlighter-rouge">data</code> object that’s at the same level as the <code class="language-plaintext highlighter-rouge">title</code> or <code class="language-plaintext highlighter-rouge">message</code>.)</li>
  <li>The app listens for a specific event, <code class="language-plaintext highlighter-rouge">notify_android_uncleared_&lt;APP_NAME&gt;</code>, where <code class="language-plaintext highlighter-rouge">&lt;APP_NAME&gt;</code> is the name of the app in the app’s YAML configuration, and where the event data matches the data you’d send in a <a href="https://companion.home-assistant.io/docs/notifications/notifications-basic"><code class="language-plaintext highlighter-rouge">notify.mobile_app_&lt;your_device_id_here&gt;</code></a> service call.</li>
  <li>When it first sees the <code class="language-plaintext highlighter-rouge">notify_android_uncleared_&lt;APP_NAME&gt;</code> event, it adds all the target devices to the list of active devices, and sends them all the notification. With every notification, it overwrites the <code class="language-plaintext highlighter-rouge">tag</code> field in the notification’s <code class="language-plaintext highlighter-rouge">data</code>, to the form <code class="language-plaintext highlighter-rouge">&lt;APP_NAME&gt;_&lt;your_device_id_here&gt;</code>.</li>
  <li>The app also listens for the <a href="https://companion.home-assistant.io/docs/notifications/notification-cleared"><code class="language-plaintext highlighter-rouge">mobile_app_notification_cleared</code></a> event. If it receives it, it checks to see if the <code class="language-plaintext highlighter-rouge">tag</code> in the event’s <code class="language-plaintext highlighter-rouge">data</code> matches the form <code class="language-plaintext highlighter-rouge">&lt;APP_NAME&gt;_&lt;your_device_id_here&gt;</code>. If so, it removes the corresponding device from the list of active devices.</li>
  <li>If the app hears the <code class="language-plaintext highlighter-rouge">notify_android_uncleared_&lt;APP_NAME&gt;</code> event again, it only sends the updated notification to targets that are still active.</li>
  <li>If the app hears the <code class="language-plaintext highlighter-rouge">notify_android_uncleared_&lt;APP_NAME&gt;</code> event but the <code class="language-plaintext highlighter-rouge">message</code> is <a href="https://companion.home-assistant.io/docs/notifications/notifications-basic/#clearing"><code class="language-plaintext highlighter-rouge">clear_notification</code></a>, then the app sends that message to all the remaining active targets, then sets a flag to indicate the session is over. The next time it hears the <code class="language-plaintext highlighter-rouge">notify_android_uncleared_&lt;APP_NAME&gt;</code> event it starts over at step (2).</li>
</ol>

<h1 id="the-code">The code</h1>

<p>Here’s the AppDaemon code, hopefully commented in enough detail to make sense:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">appdaemon.plugins.hass.hassapi</span> <span class="k">as</span> <span class="n">hass</span>


<span class="k">class</span> <span class="nc">UpdateUnclearedAndroidNotifications</span><span class="p">(</span><span class="n">hass</span><span class="p">.</span><span class="n">Hass</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">initialize</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># self.notification_targets is a set (list) of all the targets we should send notifications to
</span>        <span class="bp">self</span><span class="p">.</span><span class="n">notification_targets</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">args</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="s">"notification_targets"</span><span class="p">))</span>
        <span class="c1"># self.active_targets is the list of tags that haven't been cleared; or None if the tag is inactive
</span>        <span class="bp">self</span><span class="p">.</span><span class="n">active_targets</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="c1"># self.message_data is the default additional data we send in a notification
</span>        <span class="bp">self</span><span class="p">.</span><span class="n">notification_data</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">args</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="s">"notification_data"</span><span class="p">,</span> <span class="nb">dict</span><span class="p">())</span>
        <span class="c1"># we use a unique tag for every target to detect when a notification is cleared
</span>        <span class="bp">self</span><span class="p">.</span><span class="n">tag_prefix</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">name</span>

        <span class="c1"># Listen for the event that tells us to send a new message
</span>        <span class="bp">self</span><span class="p">.</span><span class="n">listen_event</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">notify_android_uncleared_callback</span><span class="p">,</span> <span class="s">"notify_android_uncleared_"</span> <span class="o">+</span> <span class="bp">self</span><span class="p">.</span><span class="n">tag_prefix</span><span class="p">)</span>
        <span class="c1"># Also listen for the event that tells us a notification was cleared        
</span>        <span class="bp">self</span><span class="p">.</span><span class="n">listen_event</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">notification_cleared_callback</span><span class="p">,</span> <span class="s">"mobile_app_notification_cleared"</span><span class="p">)</span>


    <span class="c1"># This method is called whenever we want to send or update a notification
</span>    <span class="k">def</span> <span class="nf">notify_android_uncleared_callback</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event_name</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">):</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">log</span><span class="p">(</span><span class="s">"event_name={}, data={}, kwargs={}"</span><span class="p">.</span><span class="nb">format</span><span class="p">(</span><span class="n">event_name</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">),</span> <span class="n">level</span><span class="o">=</span><span class="s">"DEBUG"</span><span class="p">)</span>
        
        <span class="c1"># If the tag isn't active, initialize all the notification targets
</span>        <span class="k">if</span> <span class="bp">self</span><span class="p">.</span><span class="n">active_targets</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="p">.</span><span class="n">active_targets</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">notification_targets</span><span class="p">)</span>

        <span class="c1"># Then for all remaining active targets for the given tag:
</span>        <span class="k">for</span> <span class="n">target</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">.</span><span class="n">active_targets</span><span class="p">:</span>
            <span class="c1"># Send the notification
</span>            <span class="bp">self</span><span class="p">.</span><span class="n">send_notification</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="s">"message"</span><span class="p">],</span> <span class="n">data</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="s">"title"</span><span class="p">,</span> <span class="bp">None</span><span class="p">),</span> <span class="n">data</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="s">"data"</span><span class="p">,</span> <span class="nb">dict</span><span class="p">()))</span>
        
        <span class="c1"># If the message was the special message `clear_notification`:
</span>        <span class="k">if</span> <span class="n">data</span><span class="p">[</span><span class="s">"message"</span><span class="p">]</span> <span class="o">==</span> <span class="s">"clear_notification"</span><span class="p">:</span>
            <span class="c1"># Then deactivate the tag by removing it
</span>            <span class="bp">self</span><span class="p">.</span><span class="n">active_targets</span> <span class="o">=</span> <span class="bp">None</span>
            <span class="bp">self</span><span class="p">.</span><span class="n">log</span><span class="p">(</span><span class="s">"Clearing tag {}"</span><span class="p">.</span><span class="nb">format</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">tag_prefix</span><span class="p">))</span>


    <span class="c1"># This method actually sends the notification to the given target
</span>    <span class="k">def</span> <span class="nf">send_notification</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">message</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
        <span class="c1"># First we make a copy of the default notification data
</span>        <span class="n">notification_data</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">notification_data</span><span class="p">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="c1"># Then we override it with whatever data was passed in by the event
</span>        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">data</span><span class="p">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="n">notification_data</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
        <span class="c1"># And finally we override the tag so it's unique to each target
</span>        <span class="n">notification_data</span><span class="p">[</span><span class="s">"tag"</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">tag_prefix</span> <span class="o">+</span> <span class="s">"_"</span> <span class="o">+</span> <span class="n">target</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">log</span><span class="p">(</span><span class="s">"Sending message={}, title={}, data={} to target={}"</span><span class="p">.</span><span class="nb">format</span><span class="p">(</span><span class="n">message</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">notification_data</span><span class="p">,</span> <span class="n">target</span><span class="p">),</span> <span class="n">level</span><span class="o">=</span><span class="s">"DEBUG"</span><span class="p">)</span>
        <span class="c1"># And then send the notification, with or without a title
</span>        <span class="k">if</span> <span class="n">title</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="p">.</span><span class="n">call_service</span><span class="p">(</span><span class="s">"notify/"</span><span class="o">+</span><span class="n">target</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">message</span> <span class="o">=</span> <span class="n">message</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">notification_data</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="p">.</span><span class="n">call_service</span><span class="p">(</span><span class="s">"notify/"</span><span class="o">+</span><span class="n">target</span><span class="p">,</span> <span class="n">message</span> <span class="o">=</span> <span class="n">message</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">notification_data</span><span class="p">)</span>


    <span class="c1"># This method is called when an Android device clears any notification
</span>    <span class="k">def</span> <span class="nf">notification_cleared_callback</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event_name</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">):</span>
        <span class="c1"># First check if the data contains a tag, and it starts with the tag prefix
</span>        <span class="k">if</span> <span class="s">"tag"</span> <span class="ow">in</span> <span class="n">data</span> <span class="ow">and</span> <span class="n">data</span><span class="p">[</span><span class="s">"tag"</span><span class="p">].</span><span class="n">startswith</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">tag_prefix</span><span class="p">):</span>
            <span class="c1"># Then extract the target from the tag
</span>            <span class="n">target</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s">"tag"</span><span class="p">][</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">tag_prefix</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">:]</span>
            <span class="bp">self</span><span class="p">.</span><span class="n">log</span><span class="p">(</span><span class="s">"target {} cleared notifcation with tag {}"</span><span class="p">.</span><span class="nb">format</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="bp">self</span><span class="p">.</span><span class="n">tag_prefix</span><span class="p">),</span> <span class="n">level</span><span class="o">=</span><span class="s">"DEBUG"</span><span class="p">)</span>
            <span class="c1"># And if the tag is active and the target is active, remove it
</span>            <span class="k">if</span> <span class="bp">self</span><span class="p">.</span><span class="n">active_targets</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="ow">and</span> <span class="n">target</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">.</span><span class="n">active_targets</span><span class="p">:</span>
                <span class="bp">self</span><span class="p">.</span><span class="n">log</span><span class="p">(</span><span class="s">"removing target {}"</span><span class="p">.</span><span class="nb">format</span><span class="p">(</span><span class="n">target</span><span class="p">),</span> <span class="n">level</span><span class="o">=</span><span class="s">"DEBUG"</span><span class="p">)</span>
                <span class="bp">self</span><span class="p">.</span><span class="n">active_targets</span><span class="p">.</span><span class="n">remove</span><span class="p">(</span><span class="n">target</span><span class="p">)</span>
</code></pre></div></div>

<p>And here’s some sample YAML to set up the app:</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">my_notification_tag</span><span class="pi">:</span>
  <span class="na">module</span><span class="pi">:</span> <span class="s">update_uncleared_android_notifications</span>
  <span class="na">class</span><span class="pi">:</span> <span class="s">UpdateUnclearedAndroidNotifications</span>
  <span class="na">notification_targets</span><span class="pi">:</span>
    <span class="c1"># These is the same as the &lt;your_device_id_here&gt; you would use in the notify.mobile_app_&lt;your_device_id_here&gt; service call</span>
    <span class="pi">-</span> <span class="s">mobile_app_device_id_1</span>
    <span class="pi">-</span> <span class="s">mobile_app_device_id_2</span>
  <span class="c1"># notification_data and all of its sub-fields are optional, and should match the data you'd provide to a notify.mobile_app_&lt;your_device_id_here&gt; service call</span>
  <span class="c1"># Also note that any data passed by the event will override this default data once, for that particular notification</span>
  <span class="na">notification_data</span><span class="pi">:</span>    
    <span class="na">alert_once</span><span class="pi">:</span> <span class="no">true</span>
    <span class="na">sticky</span><span class="pi">:</span> <span class="no">true</span>
    <span class="na">clickAction</span><span class="pi">:</span> <span class="s2">"</span><span class="s">/lovelace-default/some-url"</span>
    <span class="na">tag</span><span class="pi">:</span> <span class="s">some-tag</span> <span class="c1"># Note that if you specify a tag, it will be overwritten    </span>
</code></pre></div></div>

<p>Then to send the notification to all of the devices that haven’t cleared it yet, you’d fire off an event like so:</p>
<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="pi">-</span> <span class="na">event</span><span class="pi">:</span> <span class="s">notify_android_uncleared_my_notification_tag</span> <span class="c1"># Note that my_notification_tag is the name of the AppDaemon app instance</span>
  <span class="na">event_data</span><span class="pi">:</span>
    <span class="na">title</span><span class="pi">:</span> <span class="s">Some title</span> <span class="c1"># title is optional</span>
    <span class="na">message</span><span class="pi">:</span> <span class="s">Some message</span> <span class="c1"># message is required</span>
    <span class="na">data</span><span class="pi">:</span> <span class="c1"># data and all its subfields are optional</span>
      <span class="na">color</span><span class="pi">:</span> <span class="s2">"</span><span class="s">red"</span>
      <span class="na">icon_url</span><span class="pi">:</span> <span class="s2">"</span><span class="s">https://github.com/home-assistant/assets/blob/master/logo/logo-small.png?raw=true"</span>
      <span class="na">tag</span><span class="pi">:</span> <span class="s">some-tag</span> <span class="c1"># Note that if you specify a tag, it will be overwritten</span>
</code></pre></div></div>

<h1 id="using-the-app">Using the app</h1>

<p>To use the app, follow the <a href="https://appdaemon.readthedocs.io/en/latest/APPGUIDE.html">instructions in the AppDaemon documentation</a>. You’ll need to create a new python file named <code class="language-plaintext highlighter-rouge">update_uncleared_android_notifications.py</code>, and then drop the AppDaemon YAML in <code class="language-plaintext highlighter-rouge">apps.yaml</code> or another YAML config file (and configure it appropriately). Then just fire off the event from Home Assistant like shown, and you’re all set!</p>
 
                     
 
                   </div> 
                </div>
              </div>
            </div>
            <div class="col-md-3 hidden-xs">
              
<div class="sidebar ">
  <h2>In This Post:</h2>
  <ul class="toc">
  <li><a href="#goals">Goals</a></li>
  <li><a href="#complications">Complications</a></li>
  <li><a href="#high-level-overview">High level overview</a></li>
  <li><a href="#the-code">The code</a></li>
  <li><a href="#using-the-app">Using the app</a></li>
</ul>
</div>


<div class="sidebar ">
  <h2>Recent Posts</h2>
  <ul>
    
    <li><a href="/2022/11/backups/">Server Backups!</a></li>
    
    <li><a href="/2022/10/hosting-your-own-apt-repo-cache/">Hosting Your Own Apt Repo Cache</a></li>
    
    <li><a href="/2022/07/getting-home-assistant-to-tell-me-when-to-open-the-windows/">Getting Home Assistant to Tell Me When to Open the Windows</a></li>
    
    <li><a href="/2022/07/updating-uncleared-home-assistant-android-notifications-with-appdaemon/">Updating Uncleared Home Assistant Android Notifications with AppDaemon</a></li>
    
    <li><a href="/2022/07/automatically-update-parameters-of-a-sleeping-z-wave-entity-in-home-assistant/">Update Parameters of a Sleeping Z-Wave Device in Home Assistant on a Schedule</a></li>
    
  </ul>
</div>

<div class="sidebar">
  <h2>Tags</h2>
  <ul class="fa-ul">
    
    
    <li><span class="fa-li"><i class="fas fa-tag"></i></span>
            <a href="/tag/apache2" data-toggle="tooltip" data-placement="right" title="1">
        <span>apache2</span></a></li>
    
    <li><span class="fa-li"><i class="fas fa-tag"></i></span>
            <a href="/tag/appdaemon" data-toggle="tooltip" data-placement="right" title="1">
        <span>appdaemon</span></a></li>
    
    <li><span class="fa-li"><i class="fas fa-tag"></i></span>
            <a href="/tag/apt" data-toggle="tooltip" data-placement="right" title="1">
        <span>apt</span></a></li>
    
    <li><span class="fa-li"><i class="fas fa-tag"></i></span>
            <a href="/tag/apt-cacher-ng" data-toggle="tooltip" data-placement="right" title="1">
        <span>apt-cacher-ng</span></a></li>
    
    <li><span class="fa-li"><i class="fas fa-tag"></i></span>
            <a href="/tag/apt-clone" data-toggle="tooltip" data-placement="right" title="1">
        <span>apt-clone</span></a></li>
    
    <li><span class="fa-li"><i class="fas fa-tag"></i></span>
            <a href="/tag/automations" data-toggle="tooltip" data-placement="right" title="2">
        <span>automations</span></a></li>
    
    <li><span class="fa-li"><i class="fas fa-tag"></i></span>
            <a href="/tag/backups" data-toggle="tooltip" data-placement="right" title="2">
        <span>backups</span></a></li>
    
    <li><span class="fa-li"><i class="fas fa-tag"></i></span>
            <a href="/tag/blueprint" data-toggle="tooltip" data-placement="right" title="1">
        <span>blueprint</span></a></li>
    
    <li><span class="fa-li"><i class="fas fa-tag"></i></span>
            <a href="/tag/borg" data-toggle="tooltip" data-placement="right" title="1">
        <span>borg</span></a></li>
    
    <li><span class="fa-li"><i class="fas fa-tag"></i></span>
            <a href="/tag/borgmatic" data-toggle="tooltip" data-placement="right" title="1">
        <span>borgmatic</span></a></li>
    
    <li><span class="fa-li"><i class="fas fa-tag"></i></span>
            <a href="/tag/github" data-toggle="tooltip" data-placement="right" title="1">
        <span>github</span></a></li>
    
    <li><span class="fa-li"><i class="fas fa-tag"></i></span>
            <a href="/tag/homeassistant" data-toggle="tooltip" data-placement="right" title="3">
        <span>homeassistant</span></a></li>
    
    <li><span class="fa-li"><i class="fas fa-tag"></i></span>
            <a href="/tag/https" data-toggle="tooltip" data-placement="right" title="1">
        <span>https</span></a></li>
    
    <li><span class="fa-li"><i class="fas fa-tag"></i></span>
            <a href="/tag/jekyll" data-toggle="tooltip" data-placement="right" title="1">
        <span>jekyll</span></a></li>
    
    <li><span class="fa-li"><i class="fas fa-tag"></i></span>
            <a href="/tag/ruby" data-toggle="tooltip" data-placement="right" title="1">
        <span>ruby</span></a></li>
    
    <li><span class="fa-li"><i class="fas fa-tag"></i></span>
            <a href="/tag/scripts" data-toggle="tooltip" data-placement="right" title="1">
        <span>scripts</span></a></li>
    
    <li><span class="fa-li"><i class="fas fa-tag"></i></span>
            <a href="/tag/syncthing" data-toggle="tooltip" data-placement="right" title="1">
        <span>syncthing</span></a></li>
    
    <li><span class="fa-li"><i class="fas fa-tag"></i></span>
            <a href="/tag/timeshift" data-toggle="tooltip" data-placement="right" title="1">
        <span>timeshift</span></a></li>
    
    <li><span class="fa-li"><i class="fas fa-tag"></i></span>
            <a href="/tag/zwave" data-toggle="tooltip" data-placement="right" title="1">
        <span>zwave</span></a></li>
    
  </ul>
</div>

            </div>
          </div>
        </div>
      </div>
          <footer class="footer-distributed">
      <div class="container">
        <div class="footer">
          <p>Jeremy Gillula &copy; 2022
          <br>Theme: <a href="https://github.com/streetturtle/jekyll-clean-dark">Jekyll Clean Dark</a> with modifications</p>
        </div>
      </div>
    </footer>

    </div>
  </body>
</html>
